(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d21772a"],{c788:function(e,o,t){"use strict";t.r(o);var i=function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("div",{attrs:{id:"job_manager"}},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:20}},[t("el-form",{staticClass:"el-form--inline",attrs:{inline:!0,model:e.jobQueryContent}},[t("el-form-item",{attrs:{label:"任务ID"}},[t("el-input",{attrs:{placeholder:"任务ID"},model:{value:e.jobQueryContent.jobId,callback:function(o){e.$set(e.jobQueryContent,"jobId",o)},expression:"jobQueryContent.jobId"}})],1),t("el-form-item",{attrs:{label:"关键字"}},[t("el-input",{attrs:{placeholder:"关键字"},model:{value:e.jobQueryContent.keyword,callback:function(o){e.$set(e.jobQueryContent,"keyword",o)},expression:"jobQueryContent.keyword"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.listJobInfos}},[e._v("查询")]),t("el-button",{attrs:{type:"cancel"},on:{click:e.onClickReset}},[e._v("重置")])],1)],1)],1),t("el-col",{attrs:{span:4}},[t("el-row",[t("el-button",{attrs:{type:"success"},on:{click:e.onClickNewJob}},[e._v("新建任务")])],1)],1)],1),t("el-row",[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.jobInfoPageResult.data}},[t("el-table-column",{attrs:{prop:"id",label:"任务ID"}}),t("el-table-column",{attrs:{prop:"jobName",label:"任务名称"}}),t("el-table-column",{attrs:{label:"定时信息"},scopedSlots:e._u([{key:"default",fn:function(o){return[e._v(" "+e._s(o.row.timeExpressionType)+" "),t("br"),e._v(" "+e._s(o.row.timeExpression)+" ")]}}])}),t("el-table-column",{attrs:{prop:"executeType",label:"执行类型"}}),t("el-table-column",{attrs:{prop:"processorType",label:"处理器类型"}}),t("el-table-column",{attrs:{label:"状态"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:function(t){return e.changeJobStatus(o.row)}},model:{value:o.row.enable,callback:function(t){e.$set(o.row,"enable",t)},expression:"scope.row.enable"}})]}}])}),t("el-table-column",{attrs:{label:"操作",width:"240px"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.onClickModify(o.row)}}},[e._v("编辑")]),t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.onClickRun(o.row)}}},[e._v("运行")]),t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.onClickDeleteJob(o.row)}}},[e._v("删除")])]}}])})],1)],1),t("el-row",[t("el-pagination",{attrs:{layout:"prev, pager, next",total:this.jobInfoPageResult.totalItems,"page-size":this.jobInfoPageResult.pageSize,"hide-on-single-page":!0},on:{"current-change":e.onClickChangePage}})],1),t("el-dialog",{attrs:{title:"新建/修改任务",visible:e.modifiedJobFormVisible},on:{"update:visible":function(o){e.modifiedJobFormVisible=o}}},[t("el-form",{attrs:{model:e.modifiedJobForm,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"任务名称"}},[t("el-input",{model:{value:e.modifiedJobForm.jobName,callback:function(o){e.$set(e.modifiedJobForm,"jobName",o)},expression:"modifiedJobForm.jobName"}})],1),t("el-form-item",{attrs:{label:"任务描述"}},[t("el-input",{model:{value:e.modifiedJobForm.jobDescription,callback:function(o){e.$set(e.modifiedJobForm,"jobDescription",o)},expression:"modifiedJobForm.jobDescription"}})],1),t("el-form-item",{attrs:{label:"任务参数"}},[t("el-input",{model:{value:e.modifiedJobForm.jobParams,callback:function(o){e.$set(e.modifiedJobForm,"jobParams",o)},expression:"modifiedJobForm.jobParams"}})],1),t("el-form-item",{attrs:{label:"定时信息"}},[t("el-row",[t("el-col",{attrs:{span:5}},[t("el-select",{attrs:{placeholder:"时间表达式类型"},model:{value:e.modifiedJobForm.timeExpressionType,callback:function(o){e.$set(e.modifiedJobForm,"timeExpressionType",o)},expression:"modifiedJobForm.timeExpressionType"}},e._l(e.timeExpressionTypeOptions,(function(e){return t("el-option",{key:e.key,attrs:{label:e.label,value:e.key}})})),1)],1),t("el-col",{attrs:{span:19}},[t("el-input",{attrs:{placeholder:"CRON填写CRON表达式，秒级任务填写整数，API无需填写"},model:{value:e.modifiedJobForm.timeExpression,callback:function(o){e.$set(e.modifiedJobForm,"timeExpression",o)},expression:"modifiedJobForm.timeExpression"}})],1)],1)],1),t("el-form-item",{attrs:{label:"执行配置"}},[t("el-row",[t("el-col",{attrs:{span:5}},[t("el-select",{attrs:{placeholder:"执行类型"},model:{value:e.modifiedJobForm.executeType,callback:function(o){e.$set(e.modifiedJobForm,"executeType",o)},expression:"modifiedJobForm.executeType"}},e._l(e.executeTypeOptions,(function(e){return t("el-option",{key:e.key,attrs:{label:e.label,value:e.key}})})),1)],1),t("el-col",{attrs:{span:5}},[t("el-select",{attrs:{placeholder:"处理器类型"},model:{value:e.modifiedJobForm.processorType,callback:function(o){e.$set(e.modifiedJobForm,"processorType",o)},expression:"modifiedJobForm.processorType"}},e._l(e.processorTypeOptions,(function(e){return t("el-option",{key:e.key,attrs:{label:e.label,value:e.key}})})),1)],1),t("el-col",{attrs:{span:14}},[t("el-input",{attrs:{placeholder:"内置Java填写处理器的全限定类名"},model:{value:e.modifiedJobForm.processorInfo,callback:function(o){e.$set(e.modifiedJobForm,"processorInfo",o)},expression:"modifiedJobForm.processorInfo"}})],1)],1)],1),t("el-form-item",{attrs:{label:"运行配置"}},[t("el-row",[t("el-col",{attrs:{span:8}},[t("el-input",{staticClass:"ruleContent",attrs:{placeholder:"最大实例数"},model:{value:e.modifiedJobForm.maxInstanceNum,callback:function(o){e.$set(e.modifiedJobForm,"maxInstanceNum",o)},expression:"modifiedJobForm.maxInstanceNum"}},[t("template",{slot:"prepend"},[e._v("最大实例数")])],2)],1),t("el-col",{attrs:{span:8}},[t("el-input",{staticClass:"ruleContent",attrs:{placeholder:"单机线程并发度"},model:{value:e.modifiedJobForm.concurrency,callback:function(o){e.$set(e.modifiedJobForm,"concurrency",o)},expression:"modifiedJobForm.concurrency"}},[t("template",{slot:"prepend"},[e._v("单机线程并发度")])],2)],1),t("el-col",{attrs:{span:8}},[t("el-input",{staticClass:"ruleContent",attrs:{placeholder:"运行时间限制"},model:{value:e.modifiedJobForm.instanceTimeLimit,callback:function(o){e.$set(e.modifiedJobForm,"instanceTimeLimit",o)},expression:"modifiedJobForm.instanceTimeLimit"}},[t("template",{slot:"prepend"},[e._v("运行时间限制")])],2)],1)],1)],1),t("el-form-item",{attrs:{label:"重试配置"}},[t("el-row",[t("el-col",{attrs:{span:12}},[t("el-input",{staticClass:"ruleContent",attrs:{placeholder:"任务重试次数"},model:{value:e.modifiedJobForm.instanceRetryNum,callback:function(o){e.$set(e.modifiedJobForm,"instanceRetryNum",o)},expression:"modifiedJobForm.instanceRetryNum"}},[t("template",{slot:"prepend"},[e._v("任务重试次数")])],2)],1),t("el-col",{attrs:{span:12}},[t("el-input",{staticClass:"ruleContent",attrs:{placeholder:"仅MR和广播执行模式下生效"},model:{value:e.modifiedJobForm.taskRetryNum,callback:function(o){e.$set(e.modifiedJobForm,"taskRetryNum",o)},expression:"modifiedJobForm.taskRetryNum"}},[t("template",{slot:"prepend"},[e._v("子任务重试次数")])],2)],1)],1)],1),t("el-form-item",{attrs:{label:"机器配置"}},[t("el-row",[t("el-col",{attrs:{span:8}},[t("el-input",{staticClass:"ruleContent",attrs:{placeholder:"最低CPU核心数"},model:{value:e.modifiedJobForm.minCpuCores,callback:function(o){e.$set(e.modifiedJobForm,"minCpuCores",o)},expression:"modifiedJobForm.minCpuCores"}},[t("template",{slot:"prepend"},[e._v("最低CPU核心数")])],2)],1),t("el-col",{attrs:{span:8}},[t("el-input",{staticClass:"ruleContent",attrs:{placeholder:"最低内存(GB)"},model:{value:e.modifiedJobForm.minMemorySpace,callback:function(o){e.$set(e.modifiedJobForm,"minMemorySpace",o)},expression:"modifiedJobForm.minMemorySpace"}},[t("template",{slot:"prepend"},[e._v("最低内存（GB")])],2)],1),t("el-col",{attrs:{span:8}},[t("el-input",{staticClass:"ruleContent",attrs:{placeholder:"最低磁盘空间(GB)"},model:{value:e.modifiedJobForm.minDiskSpace,callback:function(o){e.$set(e.modifiedJobForm,"minDiskSpace",o)},expression:"modifiedJobForm.minDiskSpace"}},[t("template",{slot:"prepend"},[e._v("最低磁盘空间")])],2)],1)],1)],1),t("el-form-item",{attrs:{label:"集群配置"}},[t("el-row",[t("el-col",{attrs:{span:16}},[t("el-input",{staticClass:"ruleContent",attrs:{placeholder:"执行机器地址（可选，不指定代表全部；多值英文逗号分割）"},model:{value:e.modifiedJobForm.designatedWorkers,callback:function(o){e.$set(e.modifiedJobForm,"designatedWorkers",o)},expression:"modifiedJobForm.designatedWorkers"}},[t("template",{slot:"prepend"},[e._v("执行机器地址")])],2)],1),t("el-col",{attrs:{span:8}},[t("el-input",{staticClass:"ruleContent",attrs:{placeholder:"最大执行机器数量（0代表不限）"},model:{value:e.modifiedJobForm.maxWorkerCount,callback:function(o){e.$set(e.modifiedJobForm,"maxWorkerCount",o)},expression:"modifiedJobForm.maxWorkerCount"}},[t("template",{slot:"prepend"},[e._v("最大执行机器数量")])],2)],1)],1)],1),t("el-form-item",{attrs:{label:"报警配置"}},[t("el-select",{attrs:{multiple:"",filterable:"",placeholder:"选择报警通知人员"},model:{value:e.modifiedJobForm.notifyUserIds,callback:function(o){e.$set(e.modifiedJobForm,"notifyUserIds",o)},expression:"modifiedJobForm.notifyUserIds"}},e._l(e.userList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.username,value:e.id}})})),1)],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.saveJob}},[e._v("保存")]),t("el-button",{on:{click:function(o){e.modifiedJobFormVisible=!1}}},[e._v("取消")])],1)],1)],1)],1)},l=[],s={name:"JobManager",data:function(){return{modifiedJobFormVisible:!1,modifiedJobForm:{id:void 0,jobName:"",jobDescription:"",appId:this.$store.state.appInfo.id,jobParams:"",timeExpressionType:"",timeExpression:"",executeType:"",processorType:"",processorInfo:"",maxInstanceNum:1,concurrency:5,instanceTimeLimit:0,instanceRetryNum:0,taskRetryNum:1,minCpuCores:0,minMemorySpace:0,minDiskSpace:0,enable:!0,designatedWorkers:"",maxWorkerCount:0,notifyUserIds:[]},jobQueryContent:{appId:this.$store.state.appInfo.id,index:0,pageSize:10,jobId:void 0,keyword:void 0},jobInfoPageResult:{pageSize:10,totalItems:0,data:[]},timeExpressionTypeOptions:[{key:"API",label:"API"},{key:"CRON",label:"CRON"},{key:"FIX_RATE",label:"固定频率（单位毫秒）"},{key:"FIX_DELAY",label:"固定延迟（单位毫秒）"}],processorTypeOptions:[{key:"EMBEDDED_JAVA",label:"内置JAVA处理器"},{key:"SHELL",label:"Shell脚本处理器"},{key:"PYTHON",label:"Python处理器"}],executeTypeOptions:[{key:"STANDALONE",label:"单机执行"},{key:"BROADCAST",label:"广播执行"},{key:"MAP",label:"Map执行"},{key:"MAP_REDUCE",label:"MapReduce执行"}],userList:[]}},methods:{saveJob:function(){var e=this;this.axios.post("/job/save",this.modifiedJobForm).then((function(){e.modifiedJobFormVisible=!1,e.$message.success("保存成功！"),e.listJobInfos()}),(function(){return e.modifiedJobFormVisible=!1}))},listJobInfos:function(){var e=this;this.axios.post("/job/list",this.jobQueryContent).then((function(o){e.jobInfoPageResult=o}))},changeJobStatus:function(e){var o=this;!1===e.enable?o.axios.get("/job/disable?jobId="+e.id).then((function(){return o.listJobInfos()})):(this.modifiedJobForm=e,this.saveJob())},onClickNewJob:function(){this.modifiedJobForm.id=void 0,this.modifiedJobForm.jobName=void 0,this.modifiedJobForm.jobDescription=void 0,this.modifiedJobForm.jobParams=void 0,this.modifiedJobForm.timeExpression=void 0,this.modifiedJobForm.timeExpressionType=void 0,this.modifiedJobForm.processorInfo=void 0,this.modifiedJobForm.processorType=void 0,this.modifiedJobForm.executeType=void 0,this.modifiedJobFormVisible=!0},onClickModify:function(e){this.modifiedJobForm=e,this.modifiedJobFormVisible=!0},onClickRun:function(e){var o=this,t="/job/run?jobId="+e.id;this.axios.get(t).then((function(){return o.$message.success("触发成功")}))},onClickDeleteJob:function(e){var o=this,t="/job/delete?jobId="+e.id;this.axios.get(t).then((function(){o.$message.success("删除成功"),o.listJobInfos()}))},onClickChangePage:function(e){this.jobQueryContent.index=e-1,this.listJobInfos()},onClickReset:function(){this.jobQueryContent.keyword=void 0,this.jobQueryContent.jobId=void 0}},mounted:function(){var e=this;e.axios.get("/user/list").then((function(o){return e.userList=o})),this.listJobInfos()}},n=s,r=t("2877"),a=Object(r["a"])(n,i,l,!1,null,"3a10b23e",null);o["default"]=a.exports}}]);
//# sourceMappingURL=chunk-2d21772a.415195dc.js.map