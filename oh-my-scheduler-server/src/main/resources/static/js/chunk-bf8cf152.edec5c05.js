(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-bf8cf152"],{2405:function(t,e,n){"use strict";var a=n("af77"),s=n.n(a);s.a},"511a":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"instance_manager"}},[n("el-row",[n("el-col",{attrs:{span:22}},[n("el-form",{staticClass:"el-form--inline",attrs:{inline:!0,model:t.instanceQueryContent}},[n("el-form-item",{attrs:{label:"实例ID"}},[n("el-input",{attrs:{placeholder:"实例ID"},model:{value:t.instanceQueryContent.instanceId,callback:function(e){t.$set(t.instanceQueryContent,"instanceId",e)},expression:"instanceQueryContent.instanceId"}})],1),n("el-form-item",{attrs:{label:"任务ID"}},[n("el-input",{attrs:{placeholder:"任务ID"},model:{value:t.instanceQueryContent.jobId,callback:function(e){t.$set(t.instanceQueryContent,"jobId",e)},expression:"instanceQueryContent.jobId"}})],1),"WORKFLOW"===t.instanceQueryContent.type?n("el-form-item",{attrs:{label:"工作流实例ID"}},[n("el-input",{attrs:{placeholder:"工作流实例ID"},model:{value:t.instanceQueryContent.wfInstanceId,callback:function(e){t.$set(t.instanceQueryContent,"wfInstanceId",e)},expression:"instanceQueryContent.wfInstanceId"}})],1):t._e(),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:t.listInstanceInfos}},[t._v("查询")]),n("el-button",{attrs:{type:"cancel"},on:{click:t.onClickRest}},[t._v("重置")])],1)],1)],1),n("el-col",{attrs:{span:2}},[n("div",{staticStyle:{float:"right","padding-right":"10px"}},[n("el-button",{attrs:{type:"primary"},on:{click:t.listInstanceInfos}},[t._v("刷新状态")])],1)])],1),n("el-tabs",{attrs:{type:"card"},on:{"tab-click":t.listInstanceInfos},model:{value:t.instanceQueryContent.type,callback:function(e){t.$set(t.instanceQueryContent,"type",e)},expression:"instanceQueryContent.type"}},[n("el-tab-pane",{attrs:{label:"普通任务实例",name:"NORMAL"}}),n("el-tab-pane",{attrs:{label:"工作流任务实例",name:"WORKFLOW"}})],1),n("el-row",[n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.instancePageResult.data,"row-class-name":t.instanceTableRowClassName}},[n("el-table-column",{attrs:{prop:"jobId",label:"任务ID",width:"80"}}),n("el-table-column",{attrs:{prop:"jobName",label:"任务名称"}}),"WORKFLOW"===t.instanceQueryContent.type?n("el-table-column",{attrs:{prop:"wfInstanceId",label:"工作流实例ID"}}):t._e(),n("el-table-column",{attrs:{prop:"instanceId",label:"实例ID"}}),n("el-table-column",{attrs:{prop:"statusStr",label:"状态",width:"80"}}),n("el-table-column",{attrs:{prop:"actualTriggerTime",label:"触发时间"}}),n("el-table-column",{attrs:{prop:"finishedTime",label:"结束时间"}}),n("el-table-column",{attrs:{label:"操作",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{size:"medium"},on:{click:function(n){return t.onClickShowDetail(e.row)}}},[t._v("详情")]),n("el-button",{attrs:{size:"medium"},on:{click:function(n){return t.onClickShowLog(e.row)}}},[t._v("日志")]),n("el-button",{attrs:{size:"medium"},on:{click:function(n){return t.onClickStop(e.row)}}},[t._v("停止")])]}}])})],1)],1),n("el-row",[n("el-col",{attrs:{span:24}},[n("el-pagination",{attrs:{total:this.instancePageResult.totalItems,"page-size":this.instancePageResult.pageSize,layout:"prev, pager, next"},on:{"current-change":t.onClickChangeInstancePage}})],1)],1),t.instanceDetailVisible?n("el-dialog",{attrs:{title:"任务实例详情",visible:t.instanceDetailVisible},on:{"update:visible":function(e){t.instanceDetailVisible=e}}},[n("InstanceDetail",{attrs:{"instance-id":t.currentInstanceId}})],1):t._e(),n("el-dialog",{attrs:{title:"日志",visible:t.instanceLogVisible,width:"50%"},on:{"update:visible":function(e){t.instanceLogVisible=e}}},[n("el-row",[n("el-col",{staticStyle:{"margin-bottom":"20px"},attrs:{span:4,offset:20}},[n("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-download"},on:{click:function(e){return t.onclickDownloadLog()}}},[t._v("下载")])],1)],1),n("el-row",[n("el-col",{attrs:{span:24}},[n("h4",{staticStyle:{"white-space":"pre-line"}},[t._v(" "+t._s(this.paginableInstanceLog.data)+" ")])])],1),n("el-row",[n("el-col",{attrs:{span:24}},[n("el-pagination",{attrs:{"page-count":t.paginableInstanceLog.totalPages,layout:"prev, pager, next"},on:{"current-change":t.onClickChangeLogPage}})],1)],1)],1)],1)},s=[],i=n("63e7"),l={name:"InstanceManager",components:{InstanceDetail:i["a"]},data:function(){return{instanceQueryContent:{appId:this.$store.state.appInfo.id,index:0,pageSize:10,instanceId:void 0,wfInstanceId:void 0,jobId:void 0,type:"NORMAL"},instancePageResult:{pageSize:10,totalItems:0,data:[]},instanceDetailVisible:!1,logQueryContent:{instanceId:void 0,index:0},paginableInstanceLog:{index:0,totalPages:0,data:""},instanceLogVisible:!1,currentInstanceId:void 0}},methods:{listInstanceInfos:function(){var t=this;t.axios.post("/instance/list",t.instanceQueryContent).then((function(e){t.instancePageResult=e}))},onClickRest:function(){this.instanceQueryContent.jobId=void 0,this.instanceQueryContent.instanceId=void 0,this.listInstanceInfos()},onClickShowDetail:function(t){this.instanceDetailVisible=!0,this.currentInstanceId=t.instanceId},onClickStop:function(t){var e=this,n="/instance/stop?instanceId="+t.instanceId;this.axios.get(n).then((function(){e.$message.success("停止成功"),e.listInstanceInfos()}))},onClickChangeInstancePage:function(t){this.instanceQueryContent.index=t-1,this.listInstanceInfos()},instanceTableRowClassName:function(t){var e=t.row;switch(e.status){case 4:return"error-row";case 5:return"success-row";case 10:return"warning-row"}},queryLog:function(){var t=this,e="/instance/log?instanceId="+this.logQueryContent.instanceId+"&index="+this.logQueryContent.index;this.axios.get(e).then((function(e){t.paginableInstanceLog=e,t.instanceLogVisible=!0}))},onClickShowLog:function(t){this.logQueryContent.instanceId=t.instanceId,this.logQueryContent.index=0,this.queryLog()},onClickChangeLogPage:function(t){this.logQueryContent.index=t-1,this.queryLog()},onclickDownloadLog:function(){var t="/instance/downloadLogUrl?instanceId="+this.logQueryContent.instanceId;this.axios.get(t).then((function(t){return window.open(t)}))}},mounted:function(){this.listInstanceInfos()}},o=l,c=(n("2405"),n("2877")),r=Object(c["a"])(o,a,s,!1,null,"9fba5a64",null);e["default"]=r.exports},"63e7":function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-row",[n("el-col",{attrs:{offset:20}},[n("el-button",{attrs:{type:"primary"},on:{click:t.fetchInstanceDetail}},[t._v("刷新")])],1)],1),n("el-row",{staticStyle:{"margin-top":"-20px"}},[n("el-col",{attrs:{span:8}},[t._v(" 状态: "),n("span",{staticClass:"title"},[t._v(t._s(t.instanceDetail.status))])]),n("el-col",{attrs:{span:16}},[t._v(" 运行次数："),n("span",{staticClass:"title"},[t._v(t._s(t.instanceDetail.runningTimes))])])],1),n("el-row",[n("el-col",{attrs:{span:24}},[t._v(" TaskTracker地址: "),n("span",{staticClass:"title"},[t._v(" "+t._s(t.instanceDetail.taskTrackerAddress))])])],1),n("el-row",[n("el-col",{attrs:{span:8}},[t._v(" 开始时间: "),n("span",{staticClass:"title"},[t._v(" "+t._s(this.common.timestamp2Str(t.instanceDetail.actualTriggerTime)))])]),n("el-col",{attrs:{span:8}},[t._v(" 结束时间: "),n("span",{staticClass:"title"},[t._v(t._s(this.common.timestamp2Str(t.instanceDetail.finishedTime)))])])],1),n("el-row",[n("el-col",{attrs:{span:24}},[t._v(" 运行结果: "),n("span",{staticClass:"title"},[t._v(" "+t._s(t.instanceDetail.result))])])],1),n("el-row",{attrs:{id:"taskDetail"}},[t._v(" 子任务数据: "),n("span",{staticClass:"title"},[t._v(t._s(t.instanceDetail.taskDetail))])]),n("el-row",[n("span",{staticClass:"title"},[t._v("最近10条秒级任务历史记录:")]),n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.instanceDetail.subInstanceDetails}},[n("el-table-column",{attrs:{prop:"subInstanceId",label:"子实例ID",width:"100"}}),n("el-table-column",{attrs:{prop:"startTime",label:"开始时间",width:"160"}}),n("el-table-column",{attrs:{prop:"finishedTime",label:"结束时间",width:"160"}}),n("el-table-column",{attrs:{prop:"status",label:"运行状态",width:"100"}}),n("el-table-column",{attrs:{prop:"result",label:"运行结果"}})],1)],1)],1)},s=[],i={name:"InstanceDetail",props:["instanceId"],data:function(){return{instanceDetail:{}}},methods:{fetchInstanceDetail:function(){var t=this,e="/instance/detail?instanceId="+this.instanceId;this.axios.get(e).then((function(e){return t.instanceDetail=e}))}},mounted:function(){console.log("using InstanceId: "+this.instanceId),this.fetchInstanceDetail()}},l=i,o=n("2877"),c=Object(o["a"])(l,a,s,!1,null,"c05b78a6",null);e["a"]=c.exports},af77:function(t,e,n){}}]);
//# sourceMappingURL=chunk-bf8cf152.edec5c05.js.map